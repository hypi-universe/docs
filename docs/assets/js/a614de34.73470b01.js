(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3864],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),l=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=l(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=l(n),m=r,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||i;return n?a.createElement(h,o(o({ref:t},p),{},{components:n})):a.createElement(h,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1073:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return s},metadata:function(){return l},toc:function(){return p},default:function(){return d}});var a=n(2122),r=n(9756),i=(n(7294),n(3905)),o=["components"],c={id:"actions-ruby",title:"Ruby actions",sidebar_label:"Ruby actions",slug:"/actions-ruby"},s=void 0,l={unversionedId:"actions-ruby",id:"actions-ruby",isDocsHomePage:!1,title:"Ruby actions",description:"OpenWhisk requires a JSON object as output. Hence, serverless function cannot return arrays. It must return an object at the top level which can have arrays inside it.",source:"@site/content/actions-ruby.md",sourceDirName:".",slug:"/actions-ruby",permalink:"/docs/actions-ruby",editUrl:"https://github.com/hypi-universe/docs/edit/master/content/actions-ruby.md",version:"current",frontMatter:{id:"actions-ruby",title:"Ruby actions",sidebar_label:"Ruby actions",slug:"/actions-ruby"},sidebar:"docs",previous:{title:"PHP actions",permalink:"/docs/actions-php"},next:{title:"Rust actions",permalink:"/docs/actions-rust"}},p=[{value:"Packaging Ruby actions in zip files",id:"packaging-ruby-actions-in-zip-files",children:[]}],u={toc:p};function d(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"OpenWhisk requires a JSON object as output. Hence, serverless function cannot return arrays. It must return an object at the top level which can have arrays inside it."))),(0,i.kt)("p",null,"The process of creating Ruby actions is similar to that of ",(0,i.kt)("a",{parentName:"p",href:"/docs/openwhisk-actions#the-basics"},"other actions"),"."),(0,i.kt)("p",null,"The following sections guide you through creating and invoking a single Ruby action, and demonstrate how to bundle multiple Ruby files and third party dependencies."),(0,i.kt)("p",null,"Ruby actions are executed using Ruby 2.5. To use this runtime, specify the ",(0,i.kt)("inlineCode",{parentName:"p"},"wsk")," CLI parameter\n",(0,i.kt)("inlineCode",{parentName:"p"},"--kind ruby:2.5")," when creating or updating an action. This is the default when creating an action\nwith file that has a ",(0,i.kt)("inlineCode",{parentName:"p"},".rb")," extension."),(0,i.kt)("p",null,"An action is simply a top-level Ruby method. For example, create a file called ",(0,i.kt)("inlineCode",{parentName:"p"},"hello.rb"),"\nwith the following source code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ruby"},'def main(args)\n  name = args["name"] || "stranger"\n  greeting = "Hello #{name}!"\n  puts greeting\n  { "greeting" => greeting }\nend\n')),(0,i.kt)("p",null,"Ruby actions always consume a Hash and return a Hash."),(0,i.kt)("p",null,"The entry method for the action is ",(0,i.kt)("inlineCode",{parentName:"p"},"main")," by default but may be specified explicitly\nwhen creating the action with the ",(0,i.kt)("inlineCode",{parentName:"p"},"wsk")," CLI using ",(0,i.kt)("inlineCode",{parentName:"p"},"--main"),", as with any other action type."),(0,i.kt)("p",null,"You can create an OpenWhisk action called ",(0,i.kt)("inlineCode",{parentName:"p"},"hello_ruby")," from this function as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"wsk action create hello_ruby hello.rb\n")),(0,i.kt)("p",null,"The CLI automatically infers the type of the action from the source file extension.\nFor ",(0,i.kt)("inlineCode",{parentName:"p"},".rb")," source files, the action runs using a Ruby 2.5 runtime."),(0,i.kt)("p",null,"Action invocation is the same for Ruby actions as it is for ",(0,i.kt)("a",{parentName:"p",href:"/docs/openwhisk-actions#the-basics"},"any other action"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"wsk action invoke --result hello_ruby --param name World\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "greeting": "Hello World!"\n}\n')),(0,i.kt)("p",null,"Find out more about parameters in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/openwhisk-parameters"},"Working with parameters")," section."),(0,i.kt)("h3",{id:"packaging-ruby-actions-in-zip-files"},"Packaging Ruby actions in zip files"),(0,i.kt)("p",null,"You can package a Ruby action along with other files and dependent packages in a zip file.\nThe filename of the source file containing the entry point (e.g., ",(0,i.kt)("inlineCode",{parentName:"p"},"main"),") must be ",(0,i.kt)("inlineCode",{parentName:"p"},"main.rb"),".\nFor example, to create an action that includes a second file called ",(0,i.kt)("inlineCode",{parentName:"p"},"helper.rb"),",\nfirst create an archive containing your source files:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"zip -r hello_ruby.zip main.rb helper.rb\n")),(0,i.kt)("p",null,"and then create the action:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"wsk action create hello_ruby --kind ruby:2.5 hello_ruby.zip\n")),(0,i.kt)("p",null,"A few Ruby gems such as ",(0,i.kt)("inlineCode",{parentName:"p"},"mechanize")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"jwt")," are available in addition to the default and bundled gems."),(0,i.kt)("p",null,"You can use arbitrary gems so long as you use zipped actions to package all the dependencies."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Large portions of this page is copied from the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/openwhisk/tree/master/docs"},"Apache OpenWhisk documentation")," on April 23rd 2021 - where there have been customisations to match Hypi's deployment this has been noted. Apache OpenWhisk and the Apache name are the property of the Apache Foundation and licensed under the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/apache/openwhisk/blob/master/LICENSE.txt"},"Apache V2 license")," ."))))}d.isMDXComponent=!0}}]);