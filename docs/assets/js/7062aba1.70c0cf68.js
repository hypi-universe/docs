"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4124],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),h=o,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||a;return n?r.createElement(m,i(i({ref:t},c),{},{components:n})):r.createElement(m,i({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2273:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],s={id:"realtime-db",title:"Realtime database",sidebar_label:"Realtime database",slug:"/lowcode/realtime-db"},l=void 0,p={unversionedId:"lowcode/realtime-db",id:"lowcode/realtime-db",title:"Realtime database",description:"Hypi facilitates real-time monitoring of the database using Subscription method.",source:"@site/content/lowcode/realtime-db.md",sourceDirName:"lowcode",slug:"/lowcode/realtime-db",permalink:"/docs/lowcode/realtime-db",editUrl:"https://github.com/hypi-universe/docs/edit/master/content/lowcode/realtime-db.md",tags:[],version:"current",frontMatter:{id:"realtime-db",title:"Realtime database",sidebar_label:"Realtime database",slug:"/lowcode/realtime-db"},sidebar:"docs",previous:{title:"Authorisation",permalink:"/docs/lowcode/authorisation"},next:{title:"API gateway",permalink:"/docs/lowcode/apigateway"}},c=[{value:"Subscription",id:"subscription",children:[{value:"Example",id:"example",children:[],level:3}],level:2}],u={toc:c};function d(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Hypi facilitates real-time monitoring of the database using Subscription method."),(0,a.kt)("h2",{id:"subscription"},"Subscription"),(0,a.kt)("p",null,"The subscription function monitors the upsert operation on any object of any type. If the mutation (insert or update of data) happens in any field of an object, the server will push the update to all connected clients subscribed to the type for which data was added or updated. The subscription works only on the upsert function execution and not on other mutations."),(0,a.kt)("p",null,"Hypi implements the GraphQL ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/apollographql/subscriptions-transport-ws/blob/v0.9.18/PROTOCOL.md"},"subscriptions-transport-ws")," protocol. "),(0,a.kt)("p",null,"The WebSocket endpoint is ",(0,a.kt)("a",{parentName:"p",href:"wss://api.hypi.app/graphql"},"wss://api.hypi.app/graphql")),(0,a.kt)("p",null,"Suppose you are creating a messaging app. When a sender sends the message, the receiver will receive the message through a subscription. The receiver listens to the changes in the text of the message object of the sender. If the data is inserted in the text field of the message object of the sender, the receiver receives the inserted text."),(0,a.kt)("p",null,"You may add the ",(0,a.kt)("inlineCode",{parentName:"p"},"subscription")," to any field of any data type. The subscription works on the subscribed field only and not on other fields."),(0,a.kt)("h3",{id:"example"},"Example"),(0,a.kt)("p",null,"Here, we are configuring the subscription on the ",(0,a.kt)("inlineCode",{parentName:"p"},"name"),"  field of the ",(0,a.kt)("inlineCode",{parentName:"p"},"Author")," type. This switches on the listener mode of the receiver. This works as a listener/receiver socket."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},"subscription {\n  subscribe {\n    Author {\n      name\n    }\n  }\n}\n")),(0,a.kt)("p",null,"Open second ",(0,a.kt)("a",{parentName:"p",href:"/docs/lowcode/ui-gql-playground"},"Hypi GraphQL Playground")," (editor) on another tab of the browser selecting the same release and same instance. This works as a sender socket. Insert data in the name field."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'mutation Upsert($values: HypiUpsertInputUnion!) {\n  upsert(values: $values) {\n    id\n  }\n}\n{\n  "values": {\n    "Author": [\n      {\n        "hypi": {"id": "Author1"},\n        "name": "Dan Brown"\n      }       \n    ]\n  }\n}  \n')),(0,a.kt)("p",null,"You will get the notification of this insertion into the previous socket that was listening to this event."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "subscribe": {\n      "Author": {\n        "name": "Dan Brown"\n      }\n    }\n  },\n  "errors": null\n}\n')),(0,a.kt)("p",null,"You may perform any number of upsert operation. The upsert event would be notified in the listener tab."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "subscribe": {\n      "Author": {\n        "name": "Paulo Coelho"\n      }\n    }\n  },\n  "errors": null\n}\n\n{\n  "data": {\n    "subscribe": {\n      "Author": {\n        "name": "Sudha Murti"\n      }\n    }\n  },\n  "errors": null\n}    \n')),(0,a.kt)("p",null,"Please note that if you insert data in the ",(0,a.kt)("inlineCode",{parentName:"p"},"age")," field of Author1, the insertion notification will not be received."))}d.isMDXComponent=!0}}]);