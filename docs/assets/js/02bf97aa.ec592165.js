"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9012],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return m}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),u=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=u(e.components);return r.createElement(i.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(t),m=a,v=d["".concat(i,".").concat(m)]||d[m]||p[m]||l;return t?r.createElement(v,o(o({ref:n},c),{},{components:t})):r.createElement(v,o({ref:n},c))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,o=new Array(l);o[0]=d;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var u=2;u<l;u++)o[u]=t[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},1332:function(e,n,t){var r=t(7294);n.Z=function(e){var n=e.children,t=e.hidden,a=e.className;return r.createElement("div",{role:"tabpanel",hidden:t,className:a},n)}},8515:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(7462),a=t(7294),l=t(2389),o=t(5394),s=t(6010),i="tabItem_tAz6";function u(e){var n,t,l,u=e.lazy,c=e.block,p=e.defaultValue,d=e.values,m=e.groupId,v=e.className,f=a.Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=d?d:f.map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes}})),y=(0,o.lx)(h,(function(e,n){return e.value===n.value}));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var b=null===p?p:null!=(n=null!=p?p:null==(t=f.find((function(e){return e.props.default})))?void 0:t.props.value)?n:null==(l=f[0])?void 0:l.props.value;if(null!==b&&!h.some((function(e){return e.value===b})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+b+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var g=(0,o.UB)(),k=g.tabGroupChoices,w=g.setTabGroupChoices,N=(0,a.useState)(b),T=N[0],O=N[1],S=[],E=(0,o.o5)().blockElementScrollPositionUntilNextRender;if(null!=m){var j=k[m];null!=j&&j!==T&&h.some((function(e){return e.value===j}))&&O(j)}var x=function(e){var n=e.currentTarget,t=S.indexOf(n),r=h[t].value;r!==T&&(E(n),O(r),null!=m&&w(m,r))},A=function(e){var n,t=null;switch(e.key){case"ArrowRight":var r=S.indexOf(e.currentTarget)+1;t=S[r]||S[0];break;case"ArrowLeft":var a=S.indexOf(e.currentTarget)-1;t=S[a]||S[S.length-1]}null==(n=t)||n.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":c},v)},h.map((function(e){var n=e.value,t=e.label,l=e.attributes;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:T===n?0:-1,"aria-selected":T===n,key:n,ref:function(e){return S.push(e)},onKeyDown:A,onFocus:x,onClick:x},l,{className:(0,s.Z)("tabs__item",i,null==l?void 0:l.className,{"tabs__item--active":T===n})}),null!=t?t:n)}))),u?(0,a.cloneElement)(f.filter((function(e){return e.props.value===T}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},f.map((function(e,n){return(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==T})}))))}function c(e){var n=(0,l.Z)();return a.createElement(u,(0,r.Z)({key:String(n)},e))}},9670:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return u},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return d},default:function(){return v}});var r=t(7462),a=t(3366),l=(t(7294),t(3905)),o=t(8515),s=t(1332),i=["components"],u={id:"serverlessfunction",title:"Serverless Function",sidebar_label:"Serverless Function",slug:"/lowcode/serverlessfunction"},c=void 0,p={unversionedId:"lowcode/serverlessfunction",id:"lowcode/serverlessfunction",title:"Serverless Function",description:"Serverless technology are a means of adding custom behaviour without having to worry too much about infrastructure, deployment or maintenance. Serverless functions are single purpose, programmatic funcions that are hosted by cloud computing platforms. You may access serverless functions from Hypi platform. You need to have a docker image of the function created on the platform like OpenFaaS.",source:"@site/content/lowcode/serverlessfunction.md",sourceDirName:"lowcode",slug:"/lowcode/serverlessfunction",permalink:"/docs/lowcode/serverlessfunction",editUrl:"https://github.com/hypi-universe/docs/edit/master/content/lowcode/serverlessfunction.md",tags:[],version:"current",frontMatter:{id:"serverlessfunction",title:"Serverless Function",sidebar_label:"Serverless Function",slug:"/lowcode/serverlessfunction"}},d=[{value:"Create an App",id:"create-an-app",children:[],level:3},{value:"Get App ID",id:"get-app-id",children:[],level:3},{value:"Create Serverless",id:"create-serverless",children:[],level:3},{value:"Define tan directive",id:"define-tan-directive",children:[],level:3},{value:"Trigger Function",id:"trigger-function",children:[],level:3}],m={toc:d};function v(e){var n=e.components,t=(0,a.Z)(e,i);return(0,l.kt)("wrapper",(0,r.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Serverless technology are a means of adding custom behaviour without having to worry too much about infrastructure, deployment or maintenance. Serverless functions are single purpose, programmatic funcions that are hosted by cloud computing platforms. You may access serverless functions from Hypi platform. You need to have a docker image of the function created on the platform like OpenFaaS.  "),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"How to setup and use a serverless?")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#create-an-app"},"Create an App")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#get-app-id"},"Get App ID")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#create-serverless"},"Create Serverless")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#define-tan-directive"},"Define tan directive")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#trigger-function"},"Trigger Function"))),(0,l.kt)("h3",{id:"create-an-app"},"Create an App"),(0,l.kt)("p",null,"App is the basic building block of Hypi platform. Check more about App ",(0,l.kt)("a",{parentName:"p",href:"/docs/lowcode/overview"},"here"),". Create an App using ",(0,l.kt)("a",{parentName:"p",href:"/docs/lowcode/get-started"},"this")," guide."),(0,l.kt)("h3",{id:"get-app-id"},"Get App ID"),(0,l.kt)("p",null,"Run the following GraphQL query to retrieve the App ID available as ",(0,l.kt)("inlineCode",{parentName:"p"},"hypi.id"),". Note that the query returns multiple apps in your realm, so pick the one related the App that you have just created in the previous step."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'{\n  find(type: App, arcql:"*"){\n    edges{\n      node{\n        ... on App {\n          name\n          releases{\n            hypi {\n              id\n            }\n            name\n          }\n        }\n      }\n      cursor\n    }\n  }\n}\n')),(0,l.kt)("h3",{id:"create-serverless"},"Create Serverless"),(0,l.kt)("p",null,"At this point, you are ready to create the Serverless function. In order to create a serverless you should already have a containerized image ready to deploy available either in a public or a private docker registry."),(0,l.kt)("p",null,"Under the query variables, you can supply the actual parameters. Note that the parameters are a typical JSON payload. The values supplied here are for illustrative purposes only, and you need to edit them to match your use case."),(0,l.kt)(o.Z,{defaultValue:"query",values:[{label:"GraphQL Query",value:"query"},{label:"Input Data",value:"data"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"query",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"mutation upsert($values:HypiUpsertInputUnion!) {\n  upsert(values:$values){\n    id\n  }\n}\n"))),(0,l.kt)(s.Z,{value:"data",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "values": {\n    "App": {\n      "name": "test-serverless",\n      "hypi": {\n        "id": "01EJX6A9VWTV3EMDKRMW9G757X"\n      },\n      "releases": [\n        {\n          "name": "initial",\n          "hypi": {\n            "id": "01EJX6BHM5YDNX30DWTNWJB5DH"\n          },\n          "serverless": {\n            "hypi": {\n              "impl": "OpenFaaSFn"\n            },\n            "image": "functions/alpine:latest",\n            "name": "echo-app",\n            "credentials": {\n              "server": "hub.docker.com",\n              "username": "example",\n              "password": "example"\n          }\n        }\n      ]\n    }\n  }\n}\n')))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"Verify that the serverless was created")),(0,l.kt)("p",null,"In order to double check that the serverless was created successfully, then run the following GraphQL query and make sure that the serverless name exists in the retrieved list."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  find(type: App, arcql:"*"){\n    edges{\n      node{\n        ... on App {\n          name\n          releases{\n            name\n            serverless{\n              ... on OpenFaaSFn{\n                name\n                image\n                credentials {\n                  server\n                  username\n                  password\n                }\n              }\n            }\n          }\n        }\n      }\n      cursor\n    }\n  }\n}\n')),(0,l.kt)("h3",{id:"define-tan-directive"},"Define tan directive"),(0,l.kt)("p",null,"Before you start using the serverless function, you need to define a GraphQL query type that provides the parameters of the function. Here is an example definition."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'type Query {\n    f1(a:String!, b: Int!, c:Boolean!):EchoType @tan(type:OpenFaaS, name:"echoit", handler:"cat")\n}\ntype EchoType {\n        a: String\n        b: Int\n        c: Boolean\n}\n')),(0,l.kt)("p",null,"This has just defined a @tan function that accepts 3 parameters of types String, Integer, and Boolean. It returns a JSON object. The @tan directive has a few options; type, name, handler, and saveAs. They are explained below:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"type:"),"  instructs the system on which serverless backend to use, currently OpenFaaS is available as well as inline scripts written in Groovy or Velocity."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"name:"),'  the name field should match the name provided under the GraphQL "serverless" object.'),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"handler:"),'  is the script/entrypoint to execute inside the container. For example, "python main.py -env=prod" or "go run quickstart.go" ... etc.'),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"saveAs:"),'  instructs the Hypi platform to persist the result of the serverless function call as a GraphQL type in the database. For example, saveAs: "ServerlessResponse".')),(0,l.kt)("p",null,'Observe here how the @tan directive is instructed to return payload of user-defined type "EchoType". Thus, any user-defined type can be returned.'),(0,l.kt)("h3",{id:"trigger-function"},"Trigger Function"),(0,l.kt)("p",null,"It is now time to run the function and pass some real values and obtain the results. Using a query like this."),(0,l.kt)(o.Z,{defaultValue:"query",values:[{label:"GraphQL Query",value:"query"},{label:"Response",value:"response"}],mdxType:"Tabs"},(0,l.kt)(s.Z,{value:"query",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'query{\n    f1(a:"Hello, @tan", b:2329, c:true) {\n        a\n        b\n        c\n    }\n}\n'))),(0,l.kt)(s.Z,{value:"response",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": {\n    "f1": {\n      "a": "Hello, @tan",\n      "b": 2329,\n      "c": true\n    }\n  }\n}\n')))))}v.isMDXComponent=!0}}]);